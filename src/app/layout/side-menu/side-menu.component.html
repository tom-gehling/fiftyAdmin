<mat-nav-list>
    <div
        class="auth-section"
        style="padding: 16px; border-bottom: 1px solid #ccc"
    >
        <ng-container *ngIf="user$ | async as user; else noUser">
            <div *ngIf="!user.isAnonymous; else anonUser">
                <p>Logged in as: {{ user.uid }}</p>
                <button mat-button color="warn" (click)="logout()">
                    Logout
                </button>
            </div>
            <ng-template #anonUser>
                <p>Anonymous user</p>
                <button mat-button color="primary" (click)="login()">
                    Login
                </button>
            </ng-template>
        </ng-container>
        <ng-template #noUser>
            <button mat-button color="primary" (click)="login()">Login</button>
        </ng-template>
    </div>
    <ng-container *ngFor="let item of menuItems">
        <ng-container *ngIf="!item.children || item.children.length === 0">
            <a
                mat-list-item
                [routerLink]="item.path"
                routerLinkActive="active"
                (click)="onLinkClick()"
            >
                <mat-icon matListIcon>{{ item.icon }}</mat-icon>
                <span>{{ item.label }}</span>
            </a>
        </ng-container>

        <ng-container *ngIf="item.children && item.children.length > 0">
            <mat-expansion-panel>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        <mat-icon>{{ item.icon }}</mat-icon>
                        {{ item.label }}
                    </mat-panel-title>
                </mat-expansion-panel-header>

                <mat-nav-list>
                    <a
                        mat-list-item
                        *ngFor="let child of item.children"
                        [routerLink]="child.path"
                        routerLinkActive="active"
                        (click)="onLinkClick()"
                    >
                        <mat-icon matListIcon>{{ child.icon }}</mat-icon>
                        <span>{{ child.label }}</span>
                    </a>
                </mat-nav-list>
            </mat-expansion-panel>
        </ng-container>
    </ng-container>
</mat-nav-list>
